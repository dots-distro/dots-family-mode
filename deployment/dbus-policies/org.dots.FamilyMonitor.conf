<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- User can own their own monitor service instance -->
  <policy context="default">
    <allow own="org.dots.FamilyMonitor"/>
    <allow send_destination="org.dots.FamilyMonitor"/>
    <allow receive_sender="org.dots.FamilyMonitor"/>
    <allow send_interface="org.dots.FamilyMonitor"/>
  </policy>

  <!-- Monitor users can query monitor services -->
  <policy group="dots-family">
    <allow send_destination="org.dots.FamilyMonitor"
           send_interface="org.dots.FamilyMonitor"
           send_member="get_current_activity"/>
    <allow send_destination="org.dots.FamilyMonitor"
           send_interface="org.dots.FamilyMonitor"
           send_member="get_active_window"/>
    
    <!-- Receive activity signals -->
    <allow receive_sender="org.dots.FamilyMonitor"
           receive_interface="org.dots.FamilyMonitor"
           receive_member="activity_changed"/>
  </policy>

  <!-- Parent users have full access -->
  <policy group="dots-parents">
    <allow send_destination="org.dots.FamilyMonitor"
           send_interface="org.dots.FamilyMonitor"/>
    <allow receive_sender="org.dots.FamilyMonitor"
           receive_interface="org.dots.FamilyMonitor"/>
  </policy>
</busconfig>