<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- DOTS Family Mode D-Bus Policy Configuration -->
  
  <!-- Allow dots-family user to own and communicate with the service -->
  <policy user="dots-family">
    <allow own="org.dots.FamilyDaemon"/>
    <allow send_destination="org.dots.FamilyDaemon"/>
    <allow receive_sender="org.dots.FamilyDaemon"/>
  </policy>

  <!-- Allow root to own and communicate with the service -->
  <policy user="root">
    <allow own="org.dots.FamilyDaemon"/>
    <allow send_destination="org.dots.FamilyDaemon"/>
    <allow receive_sender="org.dots.FamilyDaemon"/>
  </policy>

  <!-- Allow any user to send messages to the daemon interface -->
  <policy context="default">
    <allow send_destination="org.dots.FamilyDaemon"
           send_interface="org.dots.FamilyDaemon"/>
    <allow receive_sender="org.dots.FamilyDaemon"/>
    
    <!-- Allow signal reception from family daemon -->
    <allow receive_sender="org.dots.FamilyDaemon"
           receive_interface="org.dots.FamilyDaemon"
           receive_member="PolicyUpdated"/>
    <allow receive_sender="org.dots.FamilyDaemon"
           receive_interface="org.dots.FamilyDaemon"
           receive_member="TimeLimitWarning"/>
    <allow receive_sender="org.dots.FamilyDaemon"
           receive_interface="org.dots.FamilyDaemon"
           receive_member="TamperDetected"/>
  </policy>
</busconfig>