{"id":"9108c041-8f0d-4e82-b3da-39dcef355970","entity_type":"adr","agent":"cli","timestamp":"2026-01-17T20:22:41.708280145Z","data":{"entity":{"agent":"cli","consequences":"POSITIVE: Catches integration issues unit tests cannot detect, validates real-world deployment scenarios, enables testing of privilege separation and security policies, validates systemd service dependencies and startup order. NEGATIVE: Requires VM resources (4GB+ RAM per VM), longer test cycles, more complex CI/CD setup. RISKS: eBPF tests may fail in development environments without kernel capabilities, some tests require root privileges, VM network isolation may affect DBus testing.","context":"Integration testing requires validation in complete NixOS environments with real systemd services, DBus policies, multi-user scenarios, and eBPF capabilities. The existing vm-config.nix infrastructure provides parent/child users, multiple window managers (Niri, Sway, Hyprland), and comprehensive service integration. This decision establishes VM testing as mandatory for release validation.","created_at":"2026-01-17T20:22:41.708280145Z","decision":"Implement multi-VM testing approach: 1) Use vm-config.nix variants for different window managers (Niri, Sway, Hyprland, XFCE), 2) Use nixos-modules for declarative configuration testing, 3) Create automated integration test scripts, 4) Test parent/child user separation with real Unix users, 5) Validate DBus policies in actual session bus environments, 6) Test eBPF program loading with kernel capabilities, 7) Validate systemd service startup sequences and dependencies","decision_date":null,"id":"9108c041-8f0d-4e82-b3da-39dcef355970","number":3,"status":"proposed","title":"NixOS VM Testing Strategy","updated_at":"2026-01-17T20:23:05.258651839Z"}},"content_hash":"25ff749a49b009acd324ca5e0d03bf2dc8e463fd3c77f61fd973149f1d8904cf","size_bytes":1646,"tags":[],"references":[],"metadata":{}}